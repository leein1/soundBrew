<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sound Test with Queue Bar</title>
</head>
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<body>
<h1>Sound Test with Queue Bar</h1>
<form id="myForm">
    <input type="text" name="instrument" value="PianoKing" />
    <input type="text" name="instrument" value="ViolinKing" />
    <button type="button" id="submitButton">Submit</button>
</form>

<!-- JSON 결과를 출력할 영역 -->
<pre id="output" style="background-color: #f4f4f4; padding: 10px; border: 1px solid #ddd;"></pre>

<script type="module">
import { get, post, put, deleteRequest } from '/js/fetch/standardMethod.js';

// 제외할 필드 (필요시 추가)
const excludeFields = [];

// Form 데이터를 JSON으로 변환하는 함수
function serializeFormToJSON(form) {
    const formData = new FormData(form);
    const jsonObject = {};

    formData.forEach((value, key) => {
        if (excludeFields.includes(key)) {
            return; // 제외 필드 무시
        }

        // 중범주 키 분리
        const keys = key.split('.'); // 예: 'albumDto.nickname' → ['albumDto', 'nickname']
        let current = jsonObject;

        keys.forEach((k, index) => {
            if (index === keys.length - 1) {
                // 마지막 키는 값을 할당
                if (current[k]) {
                    if (!Array.isArray(current[k])) {
                        current[k] = [current[k]];
                    }
                    current[k].push(value);
                } else {
                    current[k] = value;
                }
            } else {
                // 중간 키는 객체 생성
                if (!current[k]) {
                    current[k] = {};
                }
                current = current[k];
            }
        });
    });

    return jsonObject;
}

// 버튼 클릭 이벤트 핸들러
document.getElementById("submitButton").addEventListener("click", async() => {
    const form = document.getElementById("myForm");
    const jsonData = serializeFormToJSON(form);

     await get('/api/sounds/tracks');
});
</script>
</body>
</html>
